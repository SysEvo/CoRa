%% Figure 2. Effect of controlled subsystem over antithetic feedback control performance.
%   GÃ³mez-Schiavon & El-Samad
%   October 2023
clear

%% All panels
myXL = 'Y synthesis rate (\mu_Y)';
myYL = 'CoRa_{\Theta}(Y,\mu_Y)';

motifs = {'ATFv1','ATFv1p2','ATFv1p3','ATFv2','ATFv2p2','ATFv2p3'};
for m = 1:length(motifs)
    load(cat(2,'DATA_CoRams_',motifs{m},'_Fig2_mY_mY.mat'))
    pp = fieldnames(p);
    pN = regexprep(pp,'^m','\\mu_'); pN = regexprep(pN,'^g','\\gamma_'); pN = regexprep(pN,'^e','\\eta_'); pN = regexprep(pN,'_P','_+'); pN = regexprep(pN,'_M','_-');pN = regexprep(pN,'^b','\\beta_');pN = regexprep(pN,'kD','K_D');pN = regexprep(pN,'_$','');pN = regexprep(pN,'_Us','_\{Us\}');
    rhoN = regexprep(rho.name,'^m','\\mu_'); rhoN = regexprep(rhoN,'^g','\\gamma_'); rhoN = regexprep(rhoN,'^e','\\eta_'); rhoN = regexprep(rhoN,'_P','_+'); rhoN = regexprep(rhoN,'_M','_-');rhoN = regexprep(rhoN,'^b','\\beta_');rhoN = regexprep(rhoN,'kD','K_D');rhoN = regexprep(rhoN,'_$','');rhoN = regexprep(rhoN,'_Us','_\{Us\}');

    for i = 1:2
        fig = figure();
        fig.Units = 'inches';
        fig.PaperPosition = [2 1 4 2];
        fig.Position = fig.PaperPosition;
        C = [0 1 1;0 0.962745070457458 1;0 0.925490200519562 1;0 0.888235330581665 1;0 0.850980401039124 1;0 0.813725471496582 1;0 0.776470601558685 1;0 0.739215731620789 1;0 0.701960802078247 1;0 0.664705872535706 1;0 0.627451002597809 1;0 0.596078455448151 1;0 0.564705908298492 1;0 0.533333361148834 1;0 0.501960813999176 1;0 0.470588266849518 1;0 0.439215689897537 1;0 0.407843142747879 1;0 0.376470595598221 1;0 0.345098048448563 1;0 0.313725501298904 1;0 0.285205006599426 0.909090936183929;0 0.256684511899948 0.818181812763214;0 0.228164002299309 0.727272748947144;0 0.199643507599831 0.636363625526428;0 0.171122997999191 0.545454561710358;0 0.142602503299713 0.454545468091965;0 0.114082001149654 0.363636374473572;0 0.0855614989995956 0.272727280855179;0 0.0570410005748272 0.181818187236786;0 0.0285205002874136 0.0909090936183929;0 0 0;0 0 0;0.0909090936183929 0.0142602501437068 0.0909090936183929;0.181818187236786 0.0285205002874136 0.181818187236786;0.272727280855179 0.0427807494997978 0.272727280855179;0.363636374473572 0.0570410005748272 0.363636374473572;0.454545468091965 0.0713012516498566 0.454545468091965;0.545454561710358 0.0855614989995956 0.545454561710358;0.636363625526428 0.0998217537999153 0.636363625526428;0.727272748947144 0.114082001149654 0.727272748947144;0.818181812763214 0.128342255949974 0.818181812763214;0.909090936183929 0.142602503299713 0.909090936183929;1 0.156862750649452 1;1 0.191721141338348 1;1 0.226579532027245 1;1 0.261437922716141 1;1 0.296296298503876 1;1 0.331154674291611 1;1 0.366013079881668 1;1 0.400871455669403 1;1 0.43572986125946 1;1 0.470588237047195 1;1 0.499108731746674 1;1 0.527629256248474 1;1 0.55614972114563 1;1 0.58467024564743 1;1 0.613190710544586 1;1 0.641711235046387 1;1 0.670231759548187 1;1 0.698752224445343 1;1 0.727272748947144 1;1 0.755793213844299 1;1 0.7843137383461 1];
        hold on;
            [a b] = unique(p.(pp{i}));
            I = [b(1):b(end)];
            for j = 1:length(I)
                plot(rho.values,CoRas(I(j),:),...
                    'LineWidth',3,'Color',C(1+((j-1)*10),:),...
                    'DisplayName',cat(2,pN{i},'_0\times10^{',num2str(log10(a(j)/a(ceil(length(I)/2)))),'}'))
            end
                ylabel(myYL)
                ylim([0 1])
                xlabel(myXL)
                xlim([min(rho.values) max(rho.values)])
                title(cat(2,'Changing ',pN{i}),'FontSize',12)
                set(gca,'XScale','log','XTick',10.^[-2:2:2],'FontSize',12)
                box on

                annotation('textbox',[0.6 0.3 0.25 0.125],'BackgroundColor',[1 1 1],...
                    'String',{cat(2,pN{i},'= ',num2str(mode(p.(pp{i}))))},...
                    'FitBoxToText','on','LineWidth',3,'FontSize',10);
            print(gcf,cat(2,'RAW_Fig2_',motifs{m},'_',pp{i}),'-dpng','-r300')
    end
end

%% END   